if(typeof BX.CrmClientListView==="undefined"){BX.CrmClientListView=function(){this._selectedItem=null;this._pageAfterOpenHandler=BX.delegate(this._onAfterPageOpen,this);this._externalModel=null;this._isDirty=false};BX.extend(BX.CrmClientListView,BX.CrmEntityListView);BX.CrmClientListView.prototype.doInitialize=function(){BX.addCustomEvent("onOpenPageAfter",this._pageAfterOpenHandler)};BX.CrmClientListView.prototype.getContainer=function(){return this._container?this._container:BX.findChild(this._wrapper,{className:"crm_list_tel_list"},true,false)};BX.CrmClientListView.prototype.getItemContainers=function(){return BX.findChild(this.getContainer(),{className:"crm_list_tel"},true,true)};BX.CrmClientListView.prototype.getWaiterClassName=function(){return"crm_list_tel_wait"};BX.CrmClientListView.prototype.createModel=function(t,e){var i=this.getDispatcher();return i?i.createEntityModel(t,this.getEntityType(),e):null};BX.CrmClientListView.prototype.createItemView=function(t){t["enableQuickSelect"]=this.getSetting("enableQuickSelect",false);if(typeof t["escalation"]==="undefined"){t["escalation"]=this.getEscalation()}var e=this.getEntityType();if(e===BX.CrmContactModel.typeName){return BX.CrmClientContactListItemView.create(t)}else if(e===BX.CrmCompanyModel.typeName){return BX.CrmClientCompanyListItemView.create(t)}return null};BX.CrmClientListView.prototype.getEscalation=function(){return parseInt(this.getSetting("escalation",2))};BX.CrmClientListView.prototype.setSelectedItem=function(t){if(this._selectedItem===t){return}if(this._selectedItem){this._selectedItem.setSelected(false)}this._selectedItem=t;if(this._selectedItem){this._selectedItem.setSelected(true)}};BX.CrmClientListView.prototype.notifyItemSelected=function(t,e){var i=t.getModel();if(!i){return}var n=BX.CrmMobileContext.getCurrent();var s={id:i.getId(),caption:i.getCaption(),typeName:i.getTypeName(),contextId:this.getContextId()};if(e){i=e.getModel();if(i){s["related"]={id:i.getId(),caption:i.getCaption(),typeName:i.getTypeName()}}}n.riseEvent("onCrmClientSelect",s,this.getEscalation());window.setTimeout(n.createBackHandler(),0)};BX.CrmClientListView.prototype.getContextId=function(){return this.getSetting("contextId","")};BX.CrmClientListView.prototype.getEntityType=function(){return this.getSetting("entityType")};BX.CrmClientListView.prototype._processExternalCreate=function(t){var e=typeof t["data"]!=="undefined"?t["data"]:null;if(e){this._externalModel=BX.CrmEntityDispatcher.constructEntityModel(e,this.getEntityType())}};BX.CrmClientListView.prototype._onBeforeItemDelete=function(t){if(t&&t===this._selectedItem){this._selectedItem.setSelected(false);this._selectedItem=null}};BX.CrmClientListView.prototype._onAfterPageOpen=function(){if(this._externalModel){var t=this._externalModel;BX.CrmMobileContext.getCurrent().riseEvent("onCrmClientSelect",{typeName:t.getTypeName(),id:t.getId(),caption:t.getCaption(),contextId:this.getContextId()},2);this._externalModel=null;this._isDirty=true;BX.CrmMobileContext.getCurrent().back();return}if(this._isDirty){if(this.reload(this.getSetting("reloadUrl",true))){this._isDirty=false}}};BX.CrmClientListView.prototype._onAfterVisibilityChange=function(){if(this._searchContainer){this._searchContainer.style.display=this._isVisible?"":"none";this._enableSearch=this._isVisible}};BX.CrmClientListView.prototype.createSearchParams=function(t){var e=this.getEntityType();if(e==="CONTACT"){return{FULL_NAME:t}}else if(e==="COMPANY"){return{TITLE:t}}return null};BX.CrmClientListView.prototype.openInnerList=function(t,e){var i=BX.create("DIV",{attrs:{className:"crm_company_list"},style:{margin:"15px",padding:"10px",display:"none"}});var n=t.getContainer();n.appendChild(i);var s={};var r=t.getModel();var a=r.getTypeName();if(a===BX.CrmContactModel.typeName){s["ID"]=r.getIntParam("COMPANY_ID")}else if(a===BX.CrmCompanyModel.typeName){s["COMPANY_ID"]=r.getId()}var o=BX.CrmClientListManager.getCurrent();return BX.CrmInnerClientListView.create(this.getId()+"_"+e.toLowerCase(),{dispatcher:o.resolveDispatcher(e),container:i,entityType:e,searchPageUrl:o.resolveSearchUrl(e),searchParams:s,parentItem:t,parentList:this})};BX.CrmClientListView.items={};BX.CrmClientListView.create=function(t,e){var i=new BX.CrmClientListView;i.initialize(t,e);this.items[t]=i;return i}}if(typeof BX.CrmInnerClientListView==="undefined"){BX.CrmInnerClientListView=function(){this._selectedItem=this._parentList=this._parentItem=this._tail=null};BX.extend(BX.CrmInnerClientListView,BX.CrmEntityListView);BX.CrmInnerClientListView.prototype.doInitialize=function(){this._parentList=this.getSetting("parentList");if(!this._parentList){throw"BX.CrmInnerClientListView: Could not find parent list."}this._parentItem=this.getSetting("parentItem");if(!this._parentItem){throw"BX.CrmInnerClientListView: Could not find parent item."}this._beginSearchRequest(this.getSetting("searchParams"))};BX.CrmInnerClientListView.prototype.getEntityType=function(){return this.getSetting("entityType","")};BX.CrmInnerClientListView.prototype.getParentList=function(){return this._parentList};BX.CrmInnerClientListView.prototype.getParentItem=function(){return this._parentItem};BX.CrmInnerClientListView.prototype.getContainer=function(){if(!this._container){this._container=this.getSetting("container",null)}return this._container};BX.CrmInnerClientListView.prototype.getItemContainers=function(){return BX.findChild(this.getContainer(),{className:"crm_contactlist_tel_info"},true,true)};BX.CrmInnerClientListView.prototype.createModel=function(t,e){var i=this.getDispatcher();return i?i.createEntityModel(t,this.getEntityType(),e):null};BX.CrmInnerClientListView.prototype.createItemView=function(t){t["entityType"]=this.getSetting("entityType");return BX.CrmInnerClientListItemView.create(t)};BX.CrmInnerClientListView.prototype.setSelectedItem=function(t){if(this._selectedItem===t){return}if(this._selectedItem){this._selectedItem.setSelected(false)}this._selectedItem=t;if(this._selectedItem){this._selectedItem.setSelected(true)}};BX.CrmInnerClientListView.prototype._createStub=function(){var t="";var e=this.getEntityType();if(e===BX.CrmContactModel.typeName){t=this.getMessage("noContacts")}else if(e===BX.CrmCompanyModel.typeName){t=this.getMessage("noCompanies")}var i=this.getContainer();i.appendChild(BX.create("DIV",{attrs:{className:"crm_contact_info tac"},children:[BX.create("STRONG",{style:{color:"#9ca9b6",fontSize:"15px",display:"inline-block"},text:t})]}))};BX.CrmInnerClientListView.prototype.getMessage=function(t){var e=BX.CrmInnerClientListView.messages;return BX.type.isNotEmptyString(e[t])?e[t]:""};if(typeof BX.CrmInnerClientListView.messages==="undefined"){BX.CrmInnerClientListView.messages={}}BX.CrmInnerClientListView.items={};BX.CrmInnerClientListView.create=function(t,e){var i=new BX.CrmInnerClientListView;i.initialize(t,e);this.items[t]=i;return i};BX.CrmInnerClientListView.prototype._onSearchRequestCompleted=function(){this._parentItem.processInnerListItemsLoaded(this)};BX.CrmInnerClientListView.prototype.processItemSelection=function(t){this._parentItem.processInnerListItemSelection(this,t)}}if(typeof BX.CrmInnerClientListItemView==="undefined"){BX.CrmInnerClientListItemView=function(){this._list=this._dispatcher=this._model=this._container=this._buttonPanel=null;this._heading=this._tail=null;this._containerClickHandler=BX.delegate(this._onContainerClick,this);this._isSelected=false;this._hasLayout=false};BX.extend(BX.CrmInnerClientListItemView,BX.CrmEntityView);BX.CrmInnerClientListItemView.prototype.doInitialize=function(){this._list=this.getSetting("list",null);this._dispatcher=this.getSetting("dispatcher",null);this._model=this.getSetting("model",null);this._container=this.getSetting("container",null)};BX.CrmInnerClientListItemView.prototype.layout=function(){if(this._hasLayout){return}var t=this._model;if(!t){return}this._heading=BX.create("DIV",{attrs:{className:"clb"}});if(this._list.getItemCount()>1){this._heading.appendChild(BX.create("HR"))}this._list.getContainer().appendChild(this._heading);if(this._container){BX.cleanNode(this._container)}else{this._container=BX.create("DIV",{attrs:{className:"crm_contactlist_tel_info bdbox"},events:{click:this._containerClickHandler}});this._list.addItemView(this)}var e="";var i="";var n=t.getTypeName();if(n===BX.CrmCompanyModel.typeName){e=t.getStringParam("TITLE");i=t.getStringParam("LIST_IMAGE_URL")}else if(n===BX.CrmContactModel.typeName){e=t.getStringParam("FORMATTED_NAME");i=t.getStringParam("LIST_IMAGE_URL")}this._container.appendChild(BX.create("A",{attrs:{className:"crm_company_img",href:"#"},events:{click:BX.eventReturnFalse},children:[BX.create("SPAN",{attrs:{className:"p0"},children:[BX.create("IMG",{attrs:{className:"fln p0",src:i}})]})]}));this._container.appendChild(BX.create("STRONG",{text:e,style:{lineHeight:"41px"}}));this._tail=BX.create("DIV",{attrs:{className:"clb"}});this._list.getContainer().appendChild(this._tail);this._hasLayout=true};BX.CrmInnerClientListItemView.prototype.clearLayout=function(){if(!this._hasLayout){return}this.removeButtons();BX.remove(this._heading);this._heading=null;BX.remove(this._tail);this._tail=null;BX.cleanNode(this._container);this._list.removeItemView(this);this._container=null;this._hasLayout=false};BX.CrmInnerClientListItemView.prototype.scrollInToView=function(){if(this._container){BX.scrollToNode(this._container)}};BX.CrmInnerClientListItemView.prototype.getContainer=function(){return this._container};BX.CrmInnerClientListItemView.prototype.getModel=function(){return this._model};BX.CrmInnerClientListItemView.prototype.getModelKey=function(){return this._model?this._model.getKey():""};BX.CrmInnerClientListItemView.prototype.isSelected=function(){return this._isSelected};BX.CrmInnerClientListItemView.prototype.setSelected=function(t){t=!!t;if(this._isSelected===t){return}this._isSelected=t;if(this._isSelected){BX.addClass(this._container,"selected")}else{BX.removeClass(this._container,"selected")}if(t){this.createButtons()}else{this.removeButtons()}};BX.CrmInnerClientListItemView.prototype.getEnityType=function(){return this.getSetting("entityType","")};BX.CrmInnerClientListItemView.prototype.createButtons=function(){if(this._hasLayout&&!this._buttonPanel){this._buttonPanel=BX.CrmClientListItemButtonPanel.create({item:this,parentContainer:this._tail.parentNode,insertBefore:this._tail});this._buttonPanel.layout()}};BX.CrmInnerClientListItemView.prototype.removeButtons=function(){if(this._buttonPanel){this._buttonPanel.clearLayout();this._buttonPanel=null}};BX.CrmInnerClientListItemView.prototype.processButtonClick=function(t,e){if(!this.isSelected()){return}if(e===BX.CrmClientListItemButtonPanel.bid.cancel){this._list.setSelectedItem(null)}else if(e===BX.CrmClientListItemButtonPanel.bid.accept){this._list.processItemSelection(this)}};BX.CrmInnerClientListItemView.prototype._onContainerClick=function(t){if(!this.isSelected()){this._list.setSelectedItem(this)}return BX.PreventDefault(t)};BX.CrmInnerClientListItemView.create=function(t){var e=new BX.CrmInnerClientListItemView;e.initialize(t);return e}}if(typeof BX.CrmClientListItemView==="undefined"){BX.CrmClientListItemView=function(){this._list=this._dispatcher=this._model=this._container=this._buttonPanel=null;this._isSelected=false};BX.extend(BX.CrmClientListItemView,BX.CrmEntityView);BX.CrmClientListItemView.prototype.doInitialize=function(){this._list=this.getSetting("list",null);this._dispatcher=this.getSetting("dispatcher",null);this._model=this.getSetting("model",null);this._container=this.getSetting("container",null);this._escalation=parseInt(this.getSetting("escalation",2));if(!this._model&&this._container){var t=BX.findChild(this._container,{className:"crm_entity_info"},true,false);this._model=t?this._dispatcher.getModelById(t.value):null}if(this._model){this._model.addView(this)}this.postInitialize()};BX.CrmClientListItemView.prototype.postInitialize=function(){};BX.CrmClientListItemView.prototype.scrollInToView=function(){if(this._container){BX.scrollToNode(this._container)}};BX.CrmClientListItemView.prototype.getContainer=function(){return this._container};BX.CrmClientListItemView.prototype.getModel=function(){return this._model};BX.CrmClientListItemView.prototype.getModelKey=function(){return this._model?this._model.getKey():""};BX.CrmClientListItemView.prototype.isSelected=function(){return this._isSelected};BX.CrmClientListItemView.prototype.setSelected=function(t){t=!!t;if(this._isSelected===t){return}this._isSelected=t;if(this._isSelected){BX.addClass(this._container,"selected")}else{BX.removeClass(this._container,"selected")}if(this.isQuickSelectEnabled()){this.notitySelect()}else{if(t){this.createButtons()}else{this.removeButtons()}}};BX.CrmClientListItemView.prototype.isQuickSelectEnabled=function(){return this.getSetting("enableQuickSelect",false)};BX.CrmClientListItemView.prototype.getButtonPanel=function(){return this._buttonPanel};BX.CrmClientListItemView.prototype.createButtons=function(){if(!this._buttonPanel){this._buttonPanel=BX.CrmClientListItemButtonPanel.create({item:this,parentContainer:this._container});this._buttonPanel.layout()}};BX.CrmClientListItemView.prototype.removeButtons=function(){if(this._buttonPanel){this._buttonPanel.clearLayout();this._buttonPanel=null}};BX.CrmClientListItemView.prototype.processButtonClick=function(t,e){if(!this.isSelected()){return}if(e===BX.CrmClientListItemButtonPanel.bid.cancel){this._list.setSelectedItem(null)}else if(e===BX.CrmClientListItemButtonPanel.bid.accept){this.notitySelect()}};BX.CrmClientListItemView.prototype.getEscalation=function(){return this._escalation};BX.CrmClientListItemView.prototype.notitySelect=function(){this._list.notifyItemSelected(this,null)};BX.CrmClientListItemView.prototype.getMessage=function(t){var e=BX.CrmClientListItemView.messages;return BX.type.isNotEmptyString(e[t])?e[t]:""};if(typeof BX.CrmClientListItemView.messages==="undefined"){BX.CrmClientListItemView.messages={}}BX.CrmClientListItemView.prototype.handleModelUpdate=function(t){if(this._model!==t){return}this.layout();if(this._list){this._list.handleItemUpdate(this)}};BX.CrmClientListItemView.prototype.handleModelDelete=function(t){if(this._model!==t){return}this.clearLayout();if(this._list){this._list.handleItemDelete(this)}}}if(typeof BX.CrmClientCompanyListItemView==="undefined"){BX.CrmClientCompanyListItemView=function(){this._contactButton=this._innerList=null;this._onContactSelect=BX.delegate(this._onContactButtonClick,this);this._isInContactSelectMode=false};BX.extend(BX.CrmClientCompanyListItemView,BX.CrmClientListItemView);BX.CrmClientCompanyListItemView.prototype.postInitialize=function(){if(this._container){BX.bind(this._container,"click",BX.delegate(this._onContainerClick,this))}};BX.CrmClientCompanyListItemView.prototype.layout=function(){if(this._container){BX.cleanNode(this._container)}else{this._container=BX.create("LI",{attrs:{"class":"crm_list_tel"},events:{click:BX.delegate(this._onContainerClick,this)}});this._list.addItemView(this)}var t=this._model;if(!t){return}this._container.appendChild(BX.create("DIV",{attrs:{className:"crm_contactlist_tel_info crm_arrow"},children:[BX.create("A",{attrs:{className:"crm_company_img"},events:{click:BX.eventReturnFalse},style:{marginLeft:"10px"},children:[BX.create("SPAN",{attrs:{className:"p0"},children:[BX.create("IMG",{attrs:{className:"fln p0",src:t.getStringParam("LIST_IMAGE_URL")}})]})]}),BX.create("STRONG",{attrs:{style:{lineHeight:"41px"}},style:{lineHeight:"41px"},text:t.getStringParam("TITLE")})]}));this._container.appendChild(BX.create("DIV",{attrs:{className:"clb"}}))};BX.CrmClientCompanyListItemView.prototype.clearLayout=function(){this._list.removeItemView(this);this._container=null};BX.CrmClientCompanyListItemView.prototype._onContainerClick=function(t){if(this.isSelected()){return}this._list.setSelectedItem(this);return BX.PreventDefault(t)};BX.CrmClientCompanyListItemView.prototype.createButtons=function(){BX.CrmClientCompanyListItemView.superclass.createButtons.call(this);var t=this.getButtonPanel().getContainer();t.appendChild(BX.create("HR",{attrs:{className:"crm_hr"}}));t.appendChild(BX.create("BR"));this._contactButton=BX.create("A",{attrs:{className:"crm_buttons detail dib wa"},style:{marginTop:"0",padding:"1px 15px"},events:{click:this._onContactSelect},text:this.getMessage("contactButtonTitle")});t.appendChild(this._contactButton);t.appendChild(BX.create("BR"))};BX.CrmClientCompanyListItemView.prototype.removeButtons=function(){BX.unbind(this._contactButton,"click",this._onContactSelect);this.getButtonPanel().getContainer().removeChild(this._contactButton);this._contactButton=null;if(this._isInContactSelectMode){if(this._innerList){this._innerList.release();this._innerList=null}this._isInContactSelectMode=false}BX.CrmClientCompanyListItemView.superclass.removeButtons.call(this)};BX.CrmClientCompanyListItemView.prototype._onContactButtonClick=function(t){if(this._isInContactSelectMode){return BX.PreventDefault(t)}this._innerList=this._list.openInnerList(this,BX.CrmContactModel.typeName);this._isInContactSelectMode=true;return BX.PreventDefault(t)};BX.CrmClientCompanyListItemView.prototype.processInnerListItemsLoaded=function(t){if(t.hasItems()){this.getButtonPanel().setVisible(false)}else{BX.removeClass(this._contactButton,"dib");this._contactButton.style.display="none"}t.setVisible(true)};BX.CrmClientCompanyListItemView.prototype.processInnerListItemSelection=function(t,e){this._list.notifyItemSelected(this,e)};BX.CrmClientCompanyListItemView.prototype.getMessage=function(t){var e=BX.CrmClientCompanyListItemView.messages;if(BX.type.isNotEmptyString(e[t])){return e[t]}return BX.CrmClientCompanyListItemView.superclass.getMessage.call(this,t)};if(typeof BX.CrmClientCompanyListItemView.messages==="undefined"){BX.CrmClientCompanyListItemView.messages={}}BX.CrmClientCompanyListItemView.create=function(t){var e=new BX.CrmClientCompanyListItemView;e.initialize(t);return e}}if(typeof BX.CrmClientContactListItemView==="undefined"){BX.CrmClientContactListItemView=function(){this._companyButton=this._innerList=null;this._onCompanySelect=BX.delegate(this._onCompanyButtonClick,this);this._isInCompanySelectMode=false};BX.extend(BX.CrmClientContactListItemView,BX.CrmClientListItemView);BX.CrmClientContactListItemView.prototype.postInitialize=function(){if(this._container){BX.bind(this._container,"click",BX.delegate(this._onContainerClick,this))}};BX.CrmClientContactListItemView.prototype.layout=function(){if(this._container){BX.cleanNode(this._container)}else{this._container=BX.create("LI",{attrs:{"class":"crm_list_tel"},events:{click:BX.delegate(this._onContainerClick,this)}});this._list.addItemView(this)}var t=this._model;if(!t){return}this._container.appendChild(BX.create("DIV",{attrs:{className:"crm_contactlist_tel_info crm_arrow"},children:[BX.create("IMG",{attrs:{src:t.getStringParam("LIST_IMAGE_URL")}}),BX.create("STRONG",{text:t.getStringParam("FORMATTED_NAME")}),BX.create("SPAN",{text:t.getStringParam("LEGEND")})]}));this._container.appendChild(BX.create("DIV",{attrs:{className:"clb"}}))};BX.CrmClientContactListItemView.prototype.clearLayout=function(){BX.cleanNode(this._container);this._list.removeItemView(this);this._container=null};BX.CrmClientContactListItemView.prototype._onContainerClick=function(t){if(this.isSelected()){return}this._list.setSelectedItem(this);return BX.PreventDefault(t)};BX.CrmClientContactListItemView.prototype.createButtons=function(){BX.CrmClientContactListItemView.superclass.createButtons.call(this);var t=this.getButtonPanel().getContainer();var e=this._model;if(e&&e.getIntParam("COMPANY_ID")>0){t.appendChild(BX.create("HR",{attrs:{className:"crm_hr"}}));t.appendChild(BX.create("BR"));this._companyButton=BX.create("A",{attrs:{className:"crm_buttons detail dib wa"},style:{marginTop:"0",padding:"1px 15px"},events:{click:this._onCompanySelect},text:this.getMessage("companyButtonTitle")});t.appendChild(this._companyButton)}t.appendChild(BX.create("BR"))};BX.CrmClientContactListItemView.prototype.removeButtons=function(){if(this._companyButton){BX.unbind(this._companyButton,"click",this._onCompanySelect);this.getButtonPanel().getContainer().removeChild(this._companyButton);this._companyButton=null;if(this._isInCompanySelectMode){if(this._innerList){this._innerList.release();this._innerList=null}this._isInCompanySelectMode=false}}BX.CrmClientContactListItemView.superclass.removeButtons.call(this)};BX.CrmClientContactListItemView.prototype._onCompanyButtonClick=function(t){if(this._isInCompanySelectMode){return BX.PreventDefault(t)}this._innerList=this._list.openInnerList(this,BX.CrmCompanyModel.typeName);this._isInCompanySelectMode=true;return BX.PreventDefault(t)};BX.CrmClientContactListItemView.prototype.processInnerListItemsLoaded=function(t){if(t.hasItems()){this.getButtonPanel().setVisible(false)}else{BX.removeClass(this._companyButton,"dib");this._companyButton.style.display="none"}t.setVisible(true)};BX.CrmClientContactListItemView.prototype.processInnerListItemSelection=function(t,e){this._list.notifyItemSelected(this,e)};BX.CrmClientContactListItemView.prototype.getMessage=function(t){var e=BX.CrmClientContactListItemView.messages;if(BX.type.isNotEmptyString(e[t])){return e[t]}return BX.CrmClientContactListItemView.superclass.getMessage.call(this,t)};if(typeof BX.CrmClientContactListItemView.messages==="undefined"){BX.CrmClientContactListItemView.messages={}}BX.CrmClientContactListItemView.create=function(t){var e=new BX.CrmClientContactListItemView;e.initialize(t);return e}}if(typeof BX.CrmClientCreator==="undefined"){BX.CrmClientCreator=function(){this._typeName="";this._settings={};this._manager=null;this._view=null};BX.CrmClientCreator.prototype={initialize:function(t,e){this._typeName=t;this._settings=e?e:{};this._view=BX.CrmClientListView.items[this.getSetting("viewId")];this._manager=this.getSetting("manager",null)},getTypeName:function(){return this._typeName},getSetting:function(t,e){return this._settings.hasOwnProperty(t)?this._settings[t]:e},open:function(){var t=this.getSetting("createUrl","");if(t!==""){BX.CrmMobileContext.getCurrent().open({url:t,cache:false})}},createOpenHandler:function(){return BX.delegate(this.open,this)}};BX.CrmClientCreator.create=function(t,e){var i=new BX.CrmClientCreator;i.initialize(t,e);return i}}if(typeof BX.CrmClientCreatorManager==="undefined"){BX.CrmClientCreatorManager=function(){this._id="";this._settings={};this._items=[];this._menuCreated=false};BX.CrmClientCreatorManager.prototype={initialize:function(t,e){this._id=t;this._settings=e?e:{};var i=this.getSetting("typeMap",{});for(var n in i){if(i.hasOwnProperty(n)){var s=i[n];s["manager"]=this;this._items.push(BX.CrmClientCreator.create(n,s))}}if(this._items.length===0){return}BX.CrmMobileContext.getCurrent().createButtons({addPostButton:{type:"plus",style:"custom",callback:BX.delegate(this._onButtonClick,this)}})},getId:function(){return this._id},getSettings:function(){return this._settings},getSetting:function(t,e){return this._settings.hasOwnProperty(t)?this._settings[t]:e},setSetting:function(t,e){this._settings[t]=e},_onButtonClick:function(){var t=this._items.length;if(t===0){return}if(t===1){this._items[0].open()}else{var e=BX.CrmMobileContext.getCurrent();if(!this._menuCreated){var i=[];for(var n=0;n<t;n++){var s=this._items[n];i.push({icon:"edit",name:this.getMessage(s.getTypeName()),action:s.createOpenHandler()})}e.prepareMenu(i);this._menuCreated=true}e.showMenu()}}};BX.CrmClientCreatorManager.prototype.getMessage=function(t){var e=BX.CrmClientCreatorManager.messages;if(BX.type.isNotEmptyString(e[t])){return e[t]}return BX.CrmClientCreatorManager.superclass.getMessage.call(this,t)};if(typeof BX.CrmClientCreatorManager.messages==="undefined"){BX.CrmClientCreatorManager.messages={}}BX.CrmClientCreatorManager.create=function(t,e){var i=new BX.CrmClientCreatorManager;i.initialize(t,e);return i}}if(typeof BX.CrmClientListManager==="undefined"){BX.CrmClientListManager=function(){this._views={};this._switches={};this._dispatchers={};this._searchSettings={}};BX.CrmClientListManager.prototype={initialize:function(){},registerView:function(t){if(!t){return}this._views[t.getId()]=t},registerButton:function(t,e){if(!(BX.type.isDomNode(t)&&BX.type.isNotEmptyString(e)&&typeof this._views[e]!=="undefined")){return}this._switches[e]=BX.CrmClientListSwitch.create({manager:this,viewId:e,button:t,isActive:this._views[e].isVisible()})},registerDispatcher:function(t){if(!t){return}this._dispatchers[t.getTypeName()]=t},resolveDispatcher:function(t){return typeof this._dispatchers[t]?this._dispatchers[t]:null},registerSearchSettings:function(t){if(!t){return}var e=BX.type.isNotEmptyString(t["typeName"])?t["typeName"]:"";var i=BX.type.isNotEmptyString(t["url"])?t["url"]:"";if(e!==""&&i!==""){this._searchSettings[e]=t}},resolveSearchUrl:function(t){return typeof this._searchSettings[t]?this._searchSettings[t].url:""},switchToView:function(t){if(!(BX.type.isNotEmptyString(t)&&typeof this._views[t]!=="undefined")){return}var e;for(e in this._views){if(!this._views.hasOwnProperty(e)){continue}this._views[e].setVisible(e===t)}for(e in this._switches){if(!this._switches.hasOwnProperty(e)){continue}this._switches[e].setActive(e===t)}},createCompanyView:function(t,e,i){var n=BX.CrmCompanyModel.typeName;var s=typeof this._dispatchers[n]!=="undefined"?this._dispatchers[n]:null;var r=typeof this._searchSettings[n]!=="undefined"?this._searchSettings[n]:null;if(!s||!r){return null}return BX.CrmClientListView.create("xxx",{enableQuickSelect:true,entityType:n,dispatcher:s,wrapperId:e,contextId:i,searchPageUrl:r["url"],escalation:1})}};BX.CrmClientListManager.current=null;BX.CrmClientListManager.getCurrent=function(){if(!this.current){this.current=this.create()}return this.current};BX.CrmClientListManager.create=function(){var t=new BX.CrmClientListManager;t.initialize();return t}}if(typeof BX.CrmClientListItemButtonPanel==="undefined"){BX.CrmClientListItemButtonPanel=function(){this._settings={};this._item=null;this._parentContainer=this._container=this._acceptButton=this._cancelButton=null;this._onCancel=BX.delegate(this._onCancelClick,this);this._onAccept=BX.delegate(this._onAcceptClick,this);this._isVisible=true;this._hasLayout=false};BX.CrmClientListItemButtonPanel.bid={cancel:0,accept:1};BX.CrmClientListItemButtonPanel.prototype={initialize:function(t){this._settings=t?t:{};this._item=this.getSetting("item",null);if(!this._item){throw"BX.CrmClientListItemButtonPanel: Could not find item"}this._parentContainer=this.getSetting("parentContainer");if(!this._parentContainer){throw"BX.CrmClientListItemButtonPanel: Could not find parent container"}},getSetting:function(t,e){return this._settings.hasOwnProperty(t)?this._settings[t]:e},setVisible:function(t){t=!!t;if(this._isVisible===t){return}this._isVisible=t;if(this._hasLayout){this._container.style.display=t?"":"none"}},isVisible:function(){return this._isVisible},layout:function(){if(this._hasLayout){this.clearLayout()}this._acceptButton=BX.create("A",{attrs:{className:"crm accept-button wa"},style:{marginLeft:"0",padding:"0 10px",height:"40px",fontSize:"17px"},events:{click:this._onAccept},text:this.getMessage("acceptButtonTitle")});this._cancelButton=BX.create("A",{attrs:{className:"crm_buttons detail dib wa"},style:{marginRight:"0",marginTop:"0",padding:"1px 10px",height:"19px",lineHeight:"17px",fontSize:"17px"},events:{click:this._onCancel},text:this.getMessage("cancelButtonTitle")});this._container=BX.create("DIV",{attrs:{className:"crm_tac"},children:[BX.create("BR"),this._acceptButton,this._cancelButton,BX.create("BR")]});var t=this.getSetting("insertBefore",null);if(BX.type.isDomNode(t)){this._parentContainer.insertBefore(this._container,t)}else{this._parentContainer.appendChild(this._container)}this._container.style.display=this._isVisible?"":"none";this._hasLayout=true},clearLayout:function(){BX.unbind(this._acceptButton,"click",this._onAccept);this._container.removeChild(this._acceptButton);this._acceptButton=null;BX.unbind(this._cancelButton,"click",this._onCancel);this._container.removeChild(this._cancelButton);this._cancelButton=null;BX.cleanNode(this._container,true);this._hasLayout=false},getContainer:function(){return this._container},getMessage:function(t){var e=BX.CrmClientListItemButtonPanel.messages;return BX.type.isNotEmptyString(e[t])?e[t]:""},_onAcceptClick:function(t){this._item.processButtonClick(this,BX.CrmClientListItemButtonPanel.bid.accept);return BX.PreventDefault(t)},_onCancelClick:function(t){this._item.processButtonClick(this,BX.CrmClientListItemButtonPanel.bid.cancel);return BX.PreventDefault(t)}};if(typeof BX.CrmClientListItemButtonPanel.messages==="undefined"){BX.CrmClientListItemButtonPanel.messages={}}BX.CrmClientListItemButtonPanel.create=function(t){var e=new BX.CrmClientListItemButtonPanel;e.initialize(t);return e}}if(typeof BX.CrmClientListSwitch==="undefined"){BX.CrmClientListSwitch=function(){this._settings={};this._manager=null;this._viewId="";this._button=null;this._isActive=false};BX.CrmClientListSwitch.prototype={initialize:function(t){this._settings=t?t:{};this._manager=this.getSetting("manager",null);if(!this._manager){throw"BX.CrmClientListSwitch: Could not find manager."}this._viewId=this.getSetting("viewId","");if(!this._viewId){throw"BX.CrmClientListSwitch: Could not find view id."}this._button=this.getSetting("button",null);if(!this._button){throw"BX.CrmClientListSwitch: Could not find button."}BX.bind(this._button,"click",BX.delegate(this._onButtonClick,this));this._isActive=this.getSetting("isActive",false)},getSetting:function(t,e){return this._settings.hasOwnProperty(t)?this._settings[t]:e},getViewId:function(){return this._viewId},setActive:function(t){t=!!t;if(this._isActive===t){return}this._isActive=t;if(t){BX.addClass(this._button,"current")}else{BX.removeClass(this._button,"current")}},_onButtonClick:function(t){this._manager.switchToView(this._viewId);return BX.PreventDefault(t)}};BX.CrmClientListSwitch.create=function(t){var e=new BX.CrmClientListSwitch;e.initialize(t);return e}}
//# sourceMappingURL=script.map.js