BX.namespace("Tasks.Util");BX.Tasks.Util.Widget=BX.Tasks.Util.Base.extend({options:{scope:false,removeTemplates:false},sys:{code:"generic-widget",instanceCode:false,scope:false,parent:false},methods:{construct:function(){this.callConstruct(BX.Tasks.Util.Base);this.vars={cache:{control:{}}};this.ctrls={};this.instances={};this.tmpls=false;if(!("querySelector"in document)){throw new Error("Your browser does not support querySelector")}this.parent(this.option("parent"));if(this.option("removeTemplates")){this.findTemplates()}},destruct:function(){this.vars=null;this.sys=null;this.ctrls=null;this.tmpls=null;this.sys=null},scope:function(){return this.detectScope()},control:function(t,e){if(!e){if(typeof this.vars.cache.control[t]=="undefined"){var s=this.scope().querySelector(this.getControlSearchQuery(t));if(s!==null){this.vars.cache.control[t]=s}}return this.vars.cache.control[t]}else{return e.querySelector(this.getControlSearchQuery(t))}},controlAll:function(t,e){e=e||this.scope();return e.querySelectorAll(this.getControlSearchQuery(t))},controlP:function(t,e,s){s=s||this.scope();return BX.findParent(e,this.getControlMatchCondition(t),s)},detectScope:function(){if(this.sys.scope===false){if(this.opts.scope!==false){if(BX.type.isNotEmptyString(this.opts.scope)){var t=BX(this.opts.scope);if(BX.type.isElementNode(t)){this.sys.scope=t}else if(this.parent()){this.sys.scope=this.parent().control(this.opts.scope)}}else if(BX.type.isElementNode(this.opts.scope)){this.sys.scope=this.opts.scope}}else if(this.id()){this.sys.scope=BX("bx-component-scope-"+this.id())}if(!BX.type.isElementNode(this.sys.scope)){throw new Error("Cant find correct scope for "+this.code()+(this.id()?"."+this.id():""))}}return this.sys.scope},getFullBxId:function(t){var e=[];if(this.code()!==false){e.push(this.code())}if(this.sys.instanceCode!==false){e.push(this.sys.instanceCode)}e.push(t);return e.join("-")},getControlSearchQuery:function(t){return'[data-bx-id~="'+this.getFullBxId(t)+'"]'},getControlMatchCondition:function(t){return{attr:{"data-bx-id":new RegExp(this.getFullBxId(t))}}},code:function(){return this.sys.code},parent:function(t){if(typeof t!="undefined"&&t!=null){this.sys.parent=t}else{return this.sys.parent}},optionP:function(t,e){if(typeof e!="undefined"){this.callMethod(BX.Tasks.Base,"option",[t,e])}else{if(typeof this.opts[t]!="undefined"&&this.opts[t]!=null){return this.callMethod(BX.Tasks.Base,"option",[t])}if(this.parent()!=false){return this.parent().option(t)}return null}},instanceCode:function(t){if(typeof t!="undefined"&&BX.type.isNotEmptyString(t)){this.sys.instanceCode=t.toString().toLowerCase()}else{return this.sys.instanceCode}},findTemplates:function(){if(this.tmpls===false){this.tmpls={};var t=this.scope().querySelectorAll('script[type="text/html"]');for(var e=0;e<t.length;e++){var s=BX.data(t[e],"bx-id");if(typeof s=="string"&&s.length>0){this.tmpls[s]=t[e].innerHTML;if(this.option("removeTemplates")){BX.remove(t[e])}}}}},getNodeByTemplate:function(t,e){var s=this.template(t);return s.getNode(e,false)},getHTMLByTemplate:function(t,e){var s=this.template(t);return s.get(e)},template:function(t){if(typeof BX.Tasks.Util.Template=="undefined"){throw new ReferenceError("Template API does not seem to be included")}this.findTemplates();var e=this.getFullBxId(t);if(typeof this.tmpls[e]=="undefined"){throw new ReferenceError("No such template: "+t+" ("+e+")")}if(typeof this.tmpls[e]=="string"){this.tmpls[e]=BX.Tasks.Util.Template.compile(this.tmpls[e])}return this.tmpls[e]},bindControl:function(t,e,s){BX.bind(this.control(t),e,s)},bindDelegateControl:function(t,e,s,i){i=i||this.scope();BX.bindDelegate(i,e,this.getControlMatchCondition(t),s)},setCSSMode:function(t,e,s){this.dropCSSFlags(t+"-*",s);this.setCSSFlag(t+"-"+e,s)},dropCSSFlags:function(t,e){e=e||this.scope();var s=e.classList;t=new RegExp("^"+t.replace("*","[a-z0-9-]*")+"$");for(var i=0;i<s.length;i++){if(s[i].toString().match(t)){BX.removeClass(e,s[i])}}},setCSSFlag:function(t,e){this.changeCSSFlag(t,true,e)},dropCSSFlag:function(t,e){this.changeCSSFlag(t,false,e)},changeCSSFlag:function(t,e,s){s=s||this.scope();if(typeof t!="string"||t.length==0){return}BX[e?"addClass":"removeClass"](s,t)},toggleCSSMap:function(t,e){e=e||this.scope();var s=e.className.split(" ");var i=[];for(var n=0;n<s.length;n++){if(!(s[n]in t)){i.push(s[n])}}for(n in t){if(t[n]){i.push(n)}}e.className=i.join(" ")}}});
//# sourceMappingURL=widget.map.js