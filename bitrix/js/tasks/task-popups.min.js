(function(s){if(BX.TaskPriorityPopup)return;var t=function(s,t,e,i,p){this.items=[];this.popupId=s;this.popupClassName=t;if(BX.type.isArray(i)){for(var a=0;a<i.length;a++){if(typeof i[a]["id"]!=="undefined")this.items.push(i[a])}}this.params=p||{};this.title=e;this.popupWindow=null;this.currentTask=null;this.tasksData={};this.itemList=[]};t.prototype.show=function(s,t,e,i){if(this.popupWindow!==null)this.popupWindow.close();this.currentTask=this.__getTask(s,t,e,i);if(this.currentTask===null)return false;if(this.popupWindow==null)this.__createLayout();else this.popupWindow.setBindElement(this.currentTask.bindElement);this.__redrawList();this.popupWindow.show()};t.prototype.__createLayout=function(){var s=[];for(var t=0;t<this.items.length;t++){var e=this.items[t];var i=BX.create("a",{props:{className:"task-popup-list-item"},events:{click:BX.proxy(this.__onItemClick,{obj:this,listItem:e})},children:[BX.create("span",{props:{className:"task-popup-list-item-left"}}),BX.create("span",{props:{className:"task-popup-list-item-icon task-popup-"+this.popupClassName+"-icon-"+e.className}}),BX.create("span",{props:{className:"task-popup-list-item-text"},text:e.name}),BX.create("span",{props:{className:"task-popup-list-item-right"}})]});this.itemList[e.id]=i;s.push(i)}this.popupWindow=BX.PopupWindowManager.create("bx-task-"+this.popupId+"-popup",this.currentTask.bindElement,{autoHide:true,offsetTop:1,lightShadow:true,events:{onPopupClose:BX.proxy(this.__onPopupClose,this)},content:this.popupWindowContent=BX.create("div",{props:{className:"task-"+this.popupClassName+"-popup"},children:[BX.create("div",{props:{className:"task-"+this.popupClassName+"-popup-title"},text:this.title}),BX.create("div",{props:{className:"popup-window-hr"},children:[BX.create("i",{})]}),BX.create("div",{props:{className:"task-popup-list-list"},children:s})]})})};t.prototype.__redrawList=function(){this.__selectItem(this.currentTask.listValue)};t.prototype.__selectItem=function(s){for(var t in this.itemList){var e=this.itemList[t];if(s==t)BX.addClass(e,"task-popup-list-item-selected");else BX.removeClass(e,"task-popup-list-item-selected")}};t.prototype.__getTask=function(s,t,e,i){if(!BX.type.isNumber(s))return null;if(!this.tasksData[s]){this.tasksData[s]={id:s,bindElement:t,listItem:{},onPopupChange:i.events&&i.events.onPopupChange&&BX.type.isFunction(i.events.onPopupChange)?i.events.onPopupChange:null,onPopupClose:i.events&&i.events.onPopupClose&&BX.type.isFunction(i.events.onPopupClose)?i.events.onPopupClose:null};if(typeof e=="object")for(var p in e)this.tasksData[s][p]=e[p];else this.tasksData[s].listValue=e;if(typeof this.tasksData[s]["listValue"]!=="undefined"){for(var a=0;a<this.items.length;a++){if(this.items[a].id===this.tasksData[s].listValue){this.tasksData[s].listItem=this.items[a];break}}}}return this.tasksData[s]};t.prototype.__onItemClick=function(s){this.obj.popupWindow.close();if(this.obj.currentTask.listValue!=this.listItem.id){this.obj.currentTask.listValue=this.listItem.id;this.obj.currentTask.listItem=this.listItem;if(this.obj.currentTask.onPopupChange)this.obj.currentTask.onPopupChange()}BX.PreventDefault(s)};t.prototype.__onPopupClose=function(s){if(this.currentTask.onPopupClose)this.currentTask.onPopupClose()};var e=function(){e.superclass.constructor.apply(this,["priority","priority",BX.message("TASKS_PRIORITY"),[{id:0,name:BX.message("TASKS_PRIORITY_LOW"),className:"low"},{id:1,name:BX.message("TASKS_PRIORITY_MIDDLE"),className:"middle"},{id:2,name:BX.message("TASKS_PRIORITY_HIGH"),className:"high"}],{}])};BX.extend(e,t);BX.TaskPriorityPopup={popup:null,show:function(s,t,i,p){if(this.popup==null)this.popup=new e;this.popup.show(s,t,i,p)}};var i=function(s){i.superclass.constructor.apply(this,[s,"grade",BX.message("TASKS_MARK"),[{id:"NULL",name:BX.message("TASKS_MARK_NONE"),className:"none"},{id:"P",name:BX.message("TASKS_MARK_P"),className:"plus"},{id:"N",name:BX.message("TASKS_MARK_N"),className:"minus"}],{}])};BX.extend(i,t);BX.TaskGradePopup={simplePopup:null,show:function(s,t,e,p){if(this.simplePopup==null){this.simplePopup=new i("grade-simple")}this.simplePopup.show(s,t,e,p)}}})(window);
//# sourceMappingURL=task-popups.map.js